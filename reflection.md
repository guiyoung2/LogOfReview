# ν”„λ΅μ νΈ νκ³ λ΅ (Reflection)

ν”„λ΅μ νΈλ¥Ό μ§„ν–‰ν•λ©΄μ„ ν—·κ°λ Έλ λ‚΄μ©λ“¤μ„ μ •λ¦¬ν• λ¬Έμ„μ…λ‹λ‹¤.

## π¤” μ£Όμ” λ¬Έμ κ³Ό ν•΄κ²° κ³Όμ •

### JSON-server mock λ°μ΄ν„° api μ ν•κ³„

μ²μμ— μ„λ²„κ°€ μ—†μ–΄μ„ μ„μλ΅ mock λ°μ΄ν„°λ¥Ό json-serverλ΅ μƒμ„±ν–λ”λ°
json-serverλ΅ λ§λ“  ν”„λ΅μ νΈμƒ μ§μ ‘ κ°λ°ν™κ²½μ—μ„ μ„λ²„λ¥Ό μΌμ•Ό λ°μ΄ν„° μ‘μ„±,μƒμ„±,μμ •,μ‚­μ κ°€
κ°€λ¥ν•λ―€λ΅μ¨ λΉλ“ λμ—μ„λ•μ λ°μ΄ν„°λ¥Ό λ³µμ‚¬λ³ΈμΌλ΅ μ¶”κ°€ μƒμ„±ν•΄μ„ λ‹¤λ¥΄κ² κ΄€λ¦¬λ΅ λ³€κ²½
μ§μ ‘ κ°λ°ν™κ²½μ—μ„λ” κΈ°λ¥ ν…μ¤νΈκ°€ κ°€λ¥ν•μ§€λ§ λΉλ“ λμ—μ„λ•λ” read κΈ°λ¥λ§μΌλ΅ μμ •ν•¨

### Axios Interceptor μ΄ν•΄ν•κΈ°

**μ§λ¬Έ**: `axios.interceptors.request.use()`μ—μ„ `request`, `use()`, `config` νλΌλ―Έν„°κ°€ λ¬΄μ—‡μΈμ§€ ν—·κ°λ Έμµλ‹λ‹¤.

**ν•΄κ²°**:

- **`interceptors`**: Axiosμ μ”μ²­/μ‘λ‹µμ„ κ°€λ΅μ±„λ” κΈ°λ¥
- **`request`**: μ”μ²­μ„ λ³΄λ‚΄κΈ° μ „μ— μ‹¤ν–‰λλ” μΈν„°μ…‰ν„°
- **`use()`**: μΈν„°μ…‰ν„°λ¥Ό λ“±λ΅ν•λ” λ©”μ„λ“
  - μ²« λ²μ§Έ μΈμ: μ„±κ³µ μ‹ μ‹¤ν–‰ν•  ν•¨μ (configλ¥Ό λ°›μ)
  - λ‘ λ²μ§Έ μΈμ: μ‹¤ν¨ μ‹ μ‹¤ν–‰ν•  ν•¨μ (errorλ¥Ό λ°›μ)
- **`config`**: μ”μ²­ μ„¤μ • κ°μ²΄ (headers, url, method λ“±μ΄ ν¬ν•¨λ¨)

**μμ‹ μ½”λ“**:

```typescript
axios.interceptors.request.use(
  (config) => {
    // configλ¥Ό μμ •ν•΄μ„ λ°ν™ν•λ©΄ μ”μ²­μ— λ°μλ¨
    const token = localStorage.getItem("token");
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config; // μμ •λ configλ¥Ό λ°ν™ν•΄μ•Ό ν•¨
  },
  (error) => {
    // μ”μ²­ μ—λ¬ μ²λ¦¬
    return Promise.reject(error);
  }
);
```

**ν•µμ‹¬ ν¬μΈνΈ**:

- `config`λ¥Ό μμ •ν•κ³  λ°ν™ν•΄μ•Ό λ³€κ²½μ‚¬ν•­μ΄ μ μ©λ¨
- μΈν„°μ…‰ν„°λ” λ¨λ“  Axios μ”μ²­μ— μλ™μΌλ΅ μ μ©λ¨
- ν† ν°μ„ λ§¤λ² μλ™μΌλ΅ μ¶”κ°€ν•  ν•„μ” μ—†μ΄ μλ™μΌλ΅ ν—¤λ”μ— ν¬ν•¨λ¨

---

### React Queryμ μΏΌλ¦¬ λ¬΄ν¨ν™” (invalidateQueries)

**μ§λ¬Έ**: λ°μ΄ν„°λ¥Ό μμ •/μ‚­μ ν• ν›„ λ©λ΅μ΄ μλ™μΌλ΅ κ°±μ‹ λλ” μ›λ¦¬κ°€ κ¶κΈν–μµλ‹λ‹¤.

**ν•΄κ²°**:

- `queryClient.invalidateQueries()`λ¥Ό μ‚¬μ©ν•λ©΄ ν•΄λ‹Ή μΏΌλ¦¬λ¥Ό "λ¬΄ν¨ν™”"ν•¨
- λ¬΄ν¨ν™”λ μΏΌλ¦¬λ” μλ™μΌλ΅ λ‹¤μ‹ λ°μ΄ν„°λ¥Ό κ°€μ Έμ΄
- `queryKey`λ΅ μ–΄λ–¤ μΏΌλ¦¬λ¥Ό λ¬΄ν¨ν™”ν• μ§€ μ§€μ •

**μμ‹**:

```typescript
// λ“κΈ€ μ‘μ„± ν›„
const createCommentMutation = useMutation({
  mutationFn: createComment,
  onSuccess: () => {
    // "comments"λ΅ μ‹μ‘ν•λ” λ¨λ“  μΏΌλ¦¬λ¥Ό λ¬΄ν¨ν™”
    queryClient.invalidateQueries({ queryKey: ["comments", reviewId] });
    // β†’ μλ™μΌλ΅ λ“κΈ€ λ©λ΅μ„ λ‹¤μ‹ κ°€μ Έμ΄
  },
});
```

**ν•µμ‹¬ ν¬μΈνΈ**:

- `mutation`μ `onSuccess`μ—μ„ λ¬΄ν¨ν™”ν•λ©΄ μλ™μΌλ΅ UIκ°€ κ°±μ‹ λ¨
- μλ™μΌλ΅ `refetch()`λ¥Ό νΈμ¶ν•  ν•„μ” μ—†μ
- React Queryκ°€ μλ™μΌλ΅ μµμ‹  λ°μ΄ν„°λ¥Ό κ°€μ Έμ™€μ„ ν™”λ©΄μ„ μ—…λ°μ΄νΈν•¨

---

## π’΅ λ°°μ΄ μ 

1. **Axios Interceptor**: λ¨λ“  μ”μ²­μ— μλ™μΌλ΅ ν† ν°μ„ μ¶”κ°€ν•λ” λ°©λ²•
2. **React Query**: μ„λ²„ μƒνƒ κ΄€λ¦¬μ νΈλ¦¬ν•¨ (μΊμ‹±, μλ™ λ¦¬ν¨μΉ­)
3. **μ»΄ν¬λ„νΈ μ¬μ‚¬μ©**: κ°™μ€ νΌ μ»΄ν¬λ„νΈλ¥Ό μ‘μ„±/μμ • λ¨λ“λ΅ μ¬μ‚¬μ©
4. **λ°μ΄ν„° λ§¤ν•‘**: λ°°μ—΄μ„ κ°μ²΄λ΅ λ³€ν™ν•΄μ„ λΉ λ¥Έ μ΅°ν (users β†’ usersMap)
5. **κ¶ν• μ²΄ν¬**: λ³ΈμΈ λ°μ΄ν„°λ§ μμ •/μ‚­μ ν•  μ μλ„λ΅ μ΅°κ±΄λ¶€ λ λ”λ§

---

## π― λ‹¤μμ— κ°μ„ ν•  μ 

1. **μ—λ¬ μ²λ¦¬**: λ” μƒμ„Έν• μ—λ¬ λ©”μ‹μ§€μ™€ μ‚¬μ©μ ν”Όλ“λ°±
2. **λ΅λ”© μƒνƒ**: μ¤μΌλ ν†¤ UIλ‚ λ΅λ”© μ¤ν”Όλ„ κ°μ„ 
3. **νƒ€μ… μ•μ •μ„±**: λ” μ—„κ²©ν• TypeScript νƒ€μ… μ •μ
4. **μ„±λ¥ μµμ ν™”**: React.memo, useMemo, useCallback ν™μ©
5. **ν…μ¤νΈ**: λ‹¨μ„ ν…μ¤νΈ λ° ν†µν•© ν…μ¤νΈ μ‘μ„±
